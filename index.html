<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ch√∫c M·ª´ng 20/10 C√°c B·∫°n N·ªØ!</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Quicksand', sans-serif;
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            overflow-x: hidden;
        }
        body::after {
            position: absolute; 
            width: 0; 
            height: 0; 
            overflow: hidden; 
            z-index: -1;
            content: url('https://placehold.co/1920x1080/2b2538/e0c3fc?text=Thay+Anh+Nen+Cua+Ban+O+Day');
        }

        /* === T·ªêI ∆ØU H√ìA ANIMATION === */
        .girl-card-container {
            position: relative;
            width: 295px;
            height: 393px;
            margin: 12px;
            transition: transform 0.5s ease, z-index 0.5s ease;
            box-shadow: 0 4px 8px rgba(243, 189, 189, 0.15);
            transform-origin: bottom center;
            will-change: transform, z-index;
        }
        .girl-card {
            position: absolute;
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 12px;
            border: 4px solid white;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            cursor: pointer;
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94), box-shadow 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            transform-origin: bottom center;
            will-change: transform;
        }
        .girl-card-container:hover {
            z-index: 100 !important;
        }
        .girl-card-container:hover .girl-card {
            transform: scale(1.1) translateY(-10px);
            box-shadow: 0 15px 30px rgba(230, 73, 128, 0.5);
        }
        .girl-card-container::after {
            content: var(--flower-emoji);
            position: absolute;
            top: 0;
            right: 0;
            transform: translate(30%, -30%);
            font-size: 2em;
            text-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 10;
            animation: pulse 1.5s infinite ease-in-out;
            will-change: transform;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1) translate(30%, -30%); }
            50% { transform: scale(1.1) translate(30%, -30%); }
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #e64980;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .falling-flower {
            position: absolute;
            top: -50px;
            font-size: 2rem;
            animation: fall linear infinite;
            user-select: none;
            pointer-events: none;
            z-index: 9999;
            will-change: transform, top;
        }
        @keyframes fall {
            to {
                top: 105vh;
                transform: rotate(360deg);
            }
        }
        .memory-photo-container {
            position: absolute;
            transform-origin: bottom center;
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275), z-index 0.4s;
            cursor: pointer;
            will-change: transform, z-index;
        }
        .memory-photo {
            border: 5px solid white;
            border-radius: 4px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.25);
        }
        #modal-image {
            animation: zoomIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        @keyframes zoomIn {
            from { transform: scale(0.7); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        #thank-you-screen {
            background-image: url('https://i.postimg.cc/CLwrWpdy/No-script-just-memories-XPM-1.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }
        @keyframes scroll {
            from { transform: translateX(0); }
            to { transform: translateX(calc(-50% - 0.75rem)); }
        }
        #mini-carousel-track {
            gap: 1.5rem;
            padding: 1rem 0;
            will-change: transform;
        }
        #mini-carousel-track.animate-scroll {
            animation: scroll 20s linear infinite;
        }
        #mini-carousel-track img {
            height: 210px;
            width: auto;
            border-radius: 12px;
            border: 4px solid white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        #wish-prompt {
            transition: opacity 0.5s ease-in-out;
        }
        #envelope-container {
            position: relative;
            width: 90vw;
            max-width: 1200px;
            height: calc(90vw * 0.65);
            max-height: 750px;
            transition: transform 1s ease-in-out, opacity 1s ease-in-out;
            cursor: pointer;
            will-change: transform, opacity;
        }
        #envelope-back {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 100%;
            background-color: #FFF3E2;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        #envelope-flap {
            position: absolute;
            top: 0;
            width: 100%;
            height: 55%;
            background-color: #FFD7BA;
            transform-origin: top center;
            clip-path: polygon(0 0, 100% 0, 50% 100%);
            transition: transform 0.8s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            z-index: 10;
            will-change: transform;
        }
        #wish-card {
            opacity: 0;
            visibility: hidden;
            transform: scale(0.8);
            transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) 0.3s;
            will-change: transform, opacity, visibility;
        }
        #wish-screen.open #wish-prompt {
            opacity: 0;
            pointer-events: none;
        }
        #wish-screen.open #envelope-flap {
            transform: rotateX(180deg);
        }
        #wish-screen.open #envelope-container {
            opacity: 0;
            transform: translateY(-100px);
            pointer-events: none;
        }
        #wish-screen.open #wish-card {
            opacity: 1;
            visibility: visible;
            transform: scale(1);
        }
        @keyframes fallIn {
          from { opacity: 0; transform: translateY(-15px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .word-fall-in {
            display: inline-block;
            opacity: 0;
            animation: fallIn 0.5s ease forwards;
            will-change: transform, opacity;
        }
        #deny-gift-button {
            transition: transform 0.3s ease, background-color 0.3s ease, top 0.5s ease, left 0.5s ease;
        }

        /* === CSS CHO M√ÄN H√åNH TR√ÅI TIM === */
        #heart-svg-container {
            transition: transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        #heart-svg-container:active {
            transform: scale(0.9);
        }
        #clip-rect {
            transition: y 0.2s ease-in-out;
        }
        #heart-fill-screen.fade-out {
            opacity: 0;
            transform: scale(0.8);
        }
        .falling-heart {
            position: absolute;
            top: -10%;
            user-select: none;
            font-size: 2rem;
            animation: fall-heart linear forwards;
            pointer-events: none;
        }
        @keyframes fall-heart {
            to {
                transform: translateY(110vh) rotate(360deg);
                opacity: 0;
            }
        }
    </style>
</head>
<body class="text-gray-800">

    <audio id="background-music" loop preload="auto">
        <source src="https://files.catbox.moe/5gaece.mp3" type="audio/mpeg">
        Tr√¨nh duy·ªát c·ªßa b·∫°n kh√¥ng h·ªó tr·ª£ ph√°t nh·∫°c.
    </audio>

    <div id="falling-flower-container" class="fixed inset-0 overflow-hidden pointer-events-none"></div>

    <div id="gift-screen" class="min-h-screen w-full flex flex-col items-center justify-center p-4 text-center">
        <div id="gift-card" class="relative bg-white rounded-2xl shadow-xl p-8 md:p-12 w-11/12 md:w-1/2 lg:max-w-2xl transition-all duration-300">
            <h2 class="text-3xl md:text-5xl font-bold text-pink-600 mb-4">B·∫°n ∆°i, b·∫°n s·∫Øp c√≥ m·ªôt m√≥n qu√† c·ª±c k√¨ xinh xƒ©u ƒë·∫•y...</h2>
            <p class="text-gray-600 text-lg md:text-xl mb-10">B·∫°n c√≥ mu·ªën nh·∫≠n n√≥ kh√¥ng n√†o?</p>
            <div class="flex flex-col sm:flex-row justify-center items-center gap-6">
                <button id="accept-gift-button" class="flex items-center justify-center gap-3 bg-pink-500 text-white font-bold py-4 px-8 w-full sm:w-auto rounded-full hover:bg-pink-600 transition-all transform hover:scale-105 text-lg">
                    üéÅ D·∫° c√≥ ·∫°!
                </button>
                <button id="deny-gift-button" class="flex items-center justify-center gap-3 bg-gray-200 text-gray-700 font-bold py-4 px-8 w-full sm:w-auto rounded-full hover:bg-gray-300 text-lg">
                    ‚ù§Ô∏è Th√¥i, ng·∫°i l·∫Øm
                </button>
            </div>
        </div>
    </div>

    <div id="intro-screen" class="min-h-screen w-full hidden flex-col items-center justify-start pt-20 p-4 text-center">
        <h1 class="text-3xl md:text-5xl font-bold text-pink-700 mb-6">G·ª≠i nh·ªØng ƒëo√° hoa xinh ƒë·∫πp nh·∫•t c·ªßa ch√∫ng m√¨nhüíêüíñ,</h1>
        <div class="flex flex-col items-center gap-6 mb-8">
            <div class="flex flex-wrap justify-center items-center gap-6">
                <img src="https://i.postimg.cc/sxJLC21J/nam3.png" alt="·∫¢nh ch√†ng trai 1" class="w-44 h-44 md:w-64 md:h-64 rounded-full shadow-lg border-4 border-white object-cover">
                <img src="https://i.postimg.cc/L5SWWP4X/nam2.jpg" alt="·∫¢nh ch√†ng trai 2" class="w-44 h-44 md:w-64 md:h-64 rounded-full shadow-lg border-4 border-white object-cover">
                <img src="https://i.postimg.cc/MHwLLBZx/nam1.jpg" alt="·∫¢nh ch√†ng trai 3" class="w-44 h-44 md:w-64 md:h-64 rounded-full shadow-lg border-4 border-white object-cover">
            </div>
            <div class="flex flex-wrap justify-center items-center gap-6">
                <img src="https://i.postimg.cc/HntN1Lj7/nam4.jpg" alt="·∫¢nh ch√†ng trai 4" class="w-44 h-44 md:w-64 md:h-64 rounded-full shadow-lg border-4 border-white object-cover">
                <img src="https://i.postimg.cc/8PBvJT4R/Thi-t-k-ch-a-c-t-n-5.png" alt="·∫¢nh ch√†ng trai 5" class="w-44 h-44 md:w-64 md:h-64 rounded-full shadow-lg border-4 border-white object-cover">
            </div>
        </div>
        <p class="text-lg md:text-xl max-w-2xl mx-auto text-pink-800 mb-8">
            C√≥ l·∫Ω h√¥m nay, ch√∫ng m√¨nh kh√¥ng th·ªÉ ·ªü c·∫°nh ƒë·ªÉ trao cho c√°c c·∫≠u nh·ªØng m√≥n qu√† xinh x·∫Øn ‚Äúmade by ch√∫ng m√¨nh‚Äù nh∆∞ nh·ªØng ng√†y th√°ng ch√∫ng ta c√≤n l√† nh·ªØng h·ªçc sinh d∆∞·ªõi m√°i tr∆∞·ªùng ‚ÄúV√†ng‚Äù. Ch√∫ng m√¨nh ƒë√£ ∆∞·ªõc r·∫±ng n·∫øu ch√∫ng m√¨nh c√≥ ƒë∆∞·ª£c t√∫i th·∫ßn k·ª≥ c·ªßa Doraemon ƒë·ªÉ c√≥ th·ªÉ v∆∞·ª£t qua kho·∫£ng c√°ch ƒë·ªãa l√Ω ƒë·ªÉ ƒë·∫øn t·∫∑ng qu√† cho c√°c c·∫≠u ngay v√† lu√¥n! . Nh∆∞ng kh√¥ng sao v·ªõi t√¨nh c·∫£m m√† ch√∫ng m√¨nh d√†nh cho c√°c c·∫≠u th√¨ kh√¥ng c√≥ c√°i g√¨ c·∫£n l·∫°i ƒë∆∞·ª£c. ƒê√¢y l√† m·ªôt m√≥n qu√† ƒë∆∞·ª£c t·∫°o ra b·ªüi nguy√™n li·ªáu ch√≠nh l√† 100% t·∫•m l√≤ng, ƒë∆∞·ª£c n√™m n·∫øm th√™m r·∫•t nhi·ªÅu s·ª± tr√¢n qu√Ω, t√¨nh c·∫£m. N√≥ c√≥ th·ªÉ l√† v√¥ h√¨nh nh∆∞ng t√¨nh c·∫£m b√™n trong th√¨ ch·∫Øc ch·∫Øn s·∫Ω ‚Äúsi√™u to kh·ªïng l·ªì‚Äù ƒë√≥ nha. L∆∞u √Ω khi m·ªü ra h√£y c·∫©n th·∫≠n k·∫ªo ‚Äúƒë·ªô ƒë√°ng y√™u‚Äù s·∫Ω tr·ªën ch·∫°y ƒëi m·∫•t ti√™u ƒë·∫•y!üíñ
        </p>
        <div class="flex justify-center mt-4">
            <button id="continue-to-main-button" class="flex items-center gap-2 bg-pink-500 text-white font-bold py-3 px-8 rounded-full hover:bg-pink-600 transition-all transform hover:scale-105">
                Ti·∫øp t·ª•c s·ª± ƒë√°ng iu n√†y ‚ú®
           </button>
       </div>
    </div>

    <div id="home-screen" class="min-h-screen w-full hidden flex-col items-center justify-center p-4 text-center">
        <h1 class="text-4xl md:text-6xl font-bold text-pink-600 mb-4 animate-pulse">
            Happy Women's Day!
            <span class="block text-lg md:text-2xl font-medium text-pink-800 mt-2">G·ª≠i nh·ªØng b√¥ng hoa xinh ƒë·∫πp nh·∫•t c·ªßa nh√≥m</span>
        </h1>
        <p class="text-lg md:text-xl mb-8 text-pink-800 max-w-2xl mx-auto">
            Ch√∫ng m√¨nh mu·ªën g·ª≠i l·ªùi ch√∫c ng·ªçt ng√†o nh·∫•t ƒë·∫øn nh·ªØng b√¥ng hoa r·ª±c r·ª° c·ªßa nh√≥m. C·∫£m ∆°n c√°c c·∫≠u ƒë√£ ƒë·∫øn v√† t√¥ ƒëi·ªÉm cho nh·ªØng nƒÉm th√°ng thanh xu√¢n c·ªßa ch√∫ng m√¨nh th√™m t∆∞∆°i vui, √Ω nghƒ©a v√† ·∫•m √°p. ü•∞
        </p>
        <div id="memories-gallery" class="relative w-full h-52 md:h-64 flex justify-center items-center mb-10">
            <p class="text-gray-500">ƒêang t·∫£i ·∫£nh k·ª∑ ni·ªám...</p>
        </div>
        <p class="font-semibold text-xl mb-6 text-pink-600 max-w-2xl mx-auto">
            V√† b√¢y gi·ªù, h√£y ch·ªçn l·∫•y m·ªôt m√≥n qu√† d√†nh ri√™ng cho m√¨nh nh√©. üëá M·ªói m·ªôt m√≥n qu√† l√† m·ªôt l·ªùi nh·∫Øn g·ª≠i ch√¢n th√†nh t·ª´ tr√°i tim ch√∫ng m√¨nh. üíñ
        </p>
        <div id="fan-container" class="relative w-full h-72 flex justify-center items-end mt-40"></div>
    </div>
    
    <div id="heart-fill-screen" class="min-h-screen w-full hidden flex-col items-center justify-center p-4 text-center transition-all duration-700 ease-in-out">
        <div id="falling-hearts-container" class="absolute top-0 left-0 w-full h-full overflow-hidden z-0"></div>
        <div class="relative z-10">
             <h1 id="heart-title" class="text-2xl md:text-3xl text-pink-700 font-bold mb-6">Ch·∫°m v√†o tr√°i tim ƒë·ªÉ m·ªü kho√° b√≠ m·∫≠t nh√©!</h1>
             <div id="heart-svg-container" class="cursor-pointer mx-auto w-64 h-64 md:w-80 md:h-80">
                 <svg id="heart-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-full h-full">
                     <defs>
                         <clipPath id="heart-clip">
                             <rect id="clip-rect" x="0" y="24" width="24" height="24" />
                         </clipPath>
                     </defs>
                     <g>
                         <path fill="#e5e7eb" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                         <path fill="#ef4444" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" clip-path="url(#heart-clip)"/>
                     </g>
                 </svg>
            </div>
        </div>
    </div>

    <div id="wish-screen" class="min-h-screen w-full hidden flex-col items-center justify-center p-6 md:p-12">
        <p id="wish-prompt" class="text-2xl text-white font-semibold mb-8 text-center animate-pulse">B·∫°n c√≥ m·ªôt l√° th∆∞ m·ªõi!</p>
        <div id="envelope-container">
            <div id="envelope-back"></div>
            <div id="envelope-flap"></div>
        </div>
        <div id="wish-card" class="absolute bg-white/90 rounded-2xl shadow-2xl p-6 md:p-10 w-full max-w-[85vw]">
            <div class="grid grid-cols-1 md:grid-cols-5 gap-8 md:gap-12 items-center">
                <div class="flex flex-col items-center text-center md:col-span-2">
                    <img id="wish-image" src="" alt="·∫¢nh c√° nh√¢n" class="w-full h-auto max-h-[70vh] object-contain rounded-xl shadow-lg mb-6">
                    <div class="text-4xl space-x-4"><span>üíñ</span><span>‚ú®</span><span>üå∏</span><span>üòä</span></div>
                </div>
                <div class="flex flex-col justify-center md:col-span-3">
                    <h2 id="wish-title" class="text-3xl font-bold text-pink-600 mb-4 text-center"></h2>
                    <div id="wish-text" class="text-xl space-y-4"></div>
                    <div class="flex flex-wrap gap-4 mt-8">
                        <button id="finish-reading-btn" class="bg-pink-500 text-white font-bold py-3 px-6 rounded-full hover:bg-pink-600 transition-all self-start">B·ªçn m√¨nh ƒë·ªçc xong r·ªìi!</button>
                        <button id="generate-ai-wish-btn" class="bg-purple-500 text-white font-bold py-3 px-6 rounded-full hover:bg-purple-600 transition-all self-start">‚ú® Nh·∫≠n l·ªùi ch√∫c AI ‚ú®</button>
                    </div>
                    <div id="ai-wish-container" class="hidden mt-6 p-4 bg-pink-100/50 rounded-lg border-l-4 border-pink-400">
                        <div id="ai-wish-loading" class="loader"></div>
                        <p id="ai-wish-result" class="text-pink-700 italic" style="white-space: pre-wrap;"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="thank-you-screen" class="min-h-screen w-full hidden flex-col items-center justify-start pt-24 p-6 text-center relative">
        <div class="absolute inset-0 bg-black bg-opacity-30"></div>
        <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-2xl p-8 md:p-12 w-full max-w-5xl text-gray-800 transform transition-all duration-500 scale-95 opacity-0 relative z-10">
            <h2 class="relative text-4xl md:text-5xl font-bold text-pink-600 mb-10">
                <span class="absolute -top-5 -left-8 text-4xl text-pink-400 opacity-80 animate-pulse">üíñ</span>
                C·∫£m ∆°n c√°c b·∫°n!
                <span class="absolute -bottom-5 -right-8 text-3xl text-amber-300 opacity-80 animate-ping" style="animation-delay: 0.5s;">‚ú®</span>
            </h2>
            <div class="text-xl md:text-2xl max-w-4xl mx-auto mb-10 text-left space-y-4">
                <p>C√≥ l·∫Ω gi·ªØa h√†ng tri·ªáu ng∆∞·ªùi ngo√†i kia, vi·ªác ch√∫ng ta g·∫∑p ƒë∆∞·ª£c nhau, tr·ªü th√†nh b·∫°n b√® v√† c√πng nhau ƒëi qua nh·ªØng nƒÉm th√°ng r·ª±c r·ª° nh·∫•t c·ªßa tu·ªïi tr·∫ª, ch√≠nh l√† nh·ªù m·ªôt c√°i ‚Äúduyen‚Äù th·∫≠t di·ªáu k√¨.</p>
                <p>C·∫£m ∆°n c√°c c·∫≠u, nh·ªØng m·∫£nh gh√©p kh√¥ng th·ªÉ thi·∫øu, ƒë√£ ƒë·∫øn v√† t√¥ ƒëi·ªÉm th√™m cho b·ª©c tranh thanh xu√¢n c·ªßa ch√∫ng m√¨nh th√™m r·ª±c r·ª°, tr·ªçn v·∫πn. C·∫£m ∆°n nh·ªØng l·∫ßn gi√∫p ƒë·ª°, nh·ªØng l·ªùi ƒë·ªông vi√™n v√† c·∫£ nh·ªØng kho·∫£ng kh·∫Øc vui bu·ªìn m√† ch√∫ng ta ƒë√£ c√πng s·∫ª chia.</p>
                <p>Ch√∫ng m√¨nh mong r·∫±ng s·ª£i d√¢y duy√™n ph·∫≠n n√†y s·∫Ω m√£i b·ªÅn ch·∫∑t ƒë·ªÉ sau n√†y nh√¨n l·∫°i ch√∫ng ta ƒë·ªÅu c√≥ th·ªÉ m·ªâm c∆∞·ªùi th·∫≠t t∆∞∆°i, th·∫≠t h·∫°nh ph√∫c v√¨ ƒë√£ c√≥ nhau trong nh·ªØng nƒÉm th√°ng ƒë·∫πp nh·∫•t c·ªßa cu·ªôc ƒë·ªùi.</p>
                <i class="block text-center italic my-6">
                    ‚ÄúN∆°i ƒë·∫πp nh·∫•t l√† n∆°i ch√∫ng ta ch∆∞a t·ª´ng ƒëi qua<br>
                    Kho·∫£ng th·ªùi gian ƒë·∫πp nh·∫•t l√† kho·∫£ng th·ªùi gian kh√¥ng th·ªÉ quay tr·ªü l·∫°i‚Äù
                </i>
                <div class="text-right pr-8 md:pr-12">
                    <p>Y√™u th∆∞∆°ngüíñüíñ</p>
                    <p>Nh·ªØng ch√†ng trai c·ªßa c√°c c·∫≠u‚Ä¶</p>
                </div>
            </div>
            </div>
        <div class="absolute bottom-0 left-0 w-full pb-12 z-10">
            <div class="w-full overflow-hidden">
                <div id="mini-carousel-track" class="flex"></div>
            </div>
        </div>
    </div>

    <div id="image-modal" class="hidden fixed inset-0 bg-black bg-opacity-80 z-50 flex items-center justify-center p-4 transition-opacity duration-300">
        <button id="modal-close-btn" class="absolute top-4 right-6 text-white text-5xl font-bold hover:text-pink-300 transition-colors z-[60]">&times;</button>
        <div class="relative w-full h-full flex items-center justify-center">
             <img id="modal-image" src="" alt="·∫¢nh k·ª∑ ni·ªám ph√≥ng to" class="max-w-[95vw] max-h-[95vh] object-contain rounded-lg shadow-lg">
        </div>
    </div>

<script>
    // =================================================================
    // D·ªÆ LI·ªÜU
    // =================================================================
    const girlsData = [
        { id: 1, name: "B·∫£o Tr√¢n", avatar: "https://i.postimg.cc/cJ8p2hcn/7.png", flowerEmoji: "üå∏", wishes: [ { text: "B·∫£o Tr√¢n √†, c√≥ ng∆∞·ªùi ƒë√£ v√≠ r·∫±ng m·ªói c√¥ g√°i ƒë·ªÅu l√† m·ªôt b√¥ng hoa v√† v·ªõi ch√∫ng m√¨nh c·∫≠u c≈©ng ch√≠nh l√† m·ªôt ƒë√≥a h∆∞·ªõng d∆∞∆°ng xinh ƒë·∫πp v√† ƒë·∫∑c bi·ªát.\nM·ªói ƒë√≥a hoa h∆∞·ªõng d∆∞∆°ng lu√¥n th·ªÉ hi·ªán ƒë∆∞·ª£c s·ª± m·∫°nh m·∫Ω, v·∫ª ƒë·∫πp ƒë·∫ßy s·ª©c s·ªëng v√† cu·ªën h√∫t v√† c·∫≠u c≈©ng l√† m·ªôt ng∆∞·ªùi nh∆∞ v·∫≠y. ƒêi·ªÅu ƒë·∫∑c bi·ªát l√† c·∫≠u lu√¥n c√≥ m·ªôt n√©t \"duy√™n\" ng·∫ßm, m·ªôt v·∫ª ƒë·∫πp r·∫•t ri√™ng m√† kh√¥ng ai c√≥ ƒë∆∞·ª£c nh∆∞ s·ª± n·ªïi b·∫≠t c·ªßa h∆∞·ªõng d∆∞∆°ng trong m·ªôt v∆∞·ªùn hoa‚ú®\nCh√∫ng m√¨nh th·∫≠t s·ª± r·∫•t tr√¢n tr·ªçng m·ªôt ng∆∞·ªùi b·∫°n nh∆∞ c·∫≠u, t·ª´ n·ª• c∆∞·ªùi, √°nh m·∫Øt, s·ª± quan t√¢m ƒë·∫øn m·ªçi ng∆∞·ªùi. T·∫•t c·∫£ nh·ªØng ƒëi·ªÅu ƒë√≥ ƒë√£ t·∫°o n√™n s·ª± ƒë√°ng m·∫øn v√† h√¥m nay ch√≠nh l√† ng√†y ƒë·ªÉ t√¥n vinh, y√™u th∆∞∆°ng v√† g·ª≠i nh·ªØng l·ªùi ch√∫c t·ªët ƒë·∫πp ƒë·∫øn c·∫≠u, ng√†y m√† c·∫≠u ƒë∆∞·ª£c ph√°i nam tr√™n th·∫ø gi·ªõi n√†y y√™u qu√Ω, tr√¢n tr·ªçng v√† t·∫°o ra nh·ªØng s·ª± b·∫•t ng·ªù.\nNh√¢n ng√†y 20/10, ch√∫ng m√¨nh mu·ªën n√≥i r·∫±ng c·∫≠u th·ª±c s·ª± l√† m·ªôt m√≥n qu√† qu√Ω gi√° m√† cu·ªôc s·ªëng ƒë√£ ban t·∫∑ng ƒë·ªÉ ch√∫ng ta c√≥ th·ªÉ g·∫∑p nhau v√† ch∆°i c√πng nhau ·ªü kho·∫£ng thanh xu√¢n c·ªßa m·ªói ng∆∞·ªùi.\nH√£y lu√¥n t·ª± tin v√† y√™u l·∫•y v·∫ª ƒë·∫πp ri√™ng c√≥ c·ªßa m√¨nh nh√©, v√¨ trong m·∫Øt b·ªçn m√¨nh, c·∫≠u v√† 4 b·∫°n c√≤n l·∫°i lu√¥n l√† nh·ªØng c√¥ g√°i xinh ƒë·∫πp nh·∫•t m√† ch√∫ng m√¨nh ƒë√£ t·ª´ng ti·∫øp x√∫c. H√£y lu√¥n gi·ªØ m√£i n√©t r·∫°ng ng·ªùi, trong tr·∫ªo n√†y nh√©.\nCh√∫c cho ƒë√≥a hoa c·ªßa ch√∫ng m√¨nh c√≥ m·ªôt ng√†y 20/10 th·∫≠t h·∫°nh ph√∫c, nhi·ªÅu ni·ªÅm vui, ƒë∆∞·ª£c bao quanh b·ªüi nh·ªØng l·ªùi ch√∫c ng·ªçt ng√†o, y√™u th∆∞∆°ng ch√¢n th√†nh nh·∫•t c≈©ng nh∆∞ h√£y lu√¥n lu√¥n t√≠ch c·ª±c nh∆∞ v·∫≠y nh√©! C·∫≠u x·ª©ng ƒë√°ng nh·∫≠n ƒë∆∞·ª£c nh·ªØng ƒëi·ªÅu t·ªët ƒë·∫πp nh·∫•tü•∞üíê" }]},
        { id: 2, name: "Di·ªáu Hi·ªÅn", avatar: "https://i.postimg.cc/sxfpPz70/Thi-t-k-ch-a-c-t-n-3.png", flowerEmoji: "üå∫", wishes: [ { text: "Nh√¢n d·ªãp 20/10, t·ª•i m√¨nh mu·ªën g·ª≠i ƒë·∫øn Hi·ªÅn m·ªôt m√≥n qu√† nh·ªè c√πng v√†i d√≤ng l·ªùi ch√∫c th·∫≠t ch√¢n th√†nh. C·∫£m ∆°n Di·ªáu Hi·ªÅn v√¨ ƒë√£ lu√¥n l√† m·ªôt ng∆∞·ªùi b·∫°n d·ªÖ th∆∞∆°ng, vui t√≠nh v√† nhi·ªát t√¨nh trong nh√≥m. Ch·∫Øc ·ªü xa nh√† n√™n c≈©ng c√≥ l√∫c nh·ªõ nh√†, nh·ªõ b·∫°n b√®, nh∆∞ng t·ª•i m√¨nh mong r·∫±ng m√≥n qu√† nh·ªè n√†y s·∫Ω l√†m Hi·ªÅn th·∫•y ·∫•m l√≤ng h∆°n m·ªôt ch√∫t. Hy v·ªçng sau n√†y, d√π c√≥ m·ªói ƒë·ª©a ƒëi m·ªôt h∆∞·ªõng, t·ª•i m√¨nh v·∫´n s·∫Ω gi·ªØ ƒë∆∞·ª£c t√¨nh b·∫°n vui v·∫ª, tho·∫£i m√°i nh∆∞ b√¢y gi·ªù. Ch√∫c Hi·ªÅn ng√†y 20/10 th·∫≠t vui v√† √Ω nghƒ©a! Ch√∫c Hi·ªÅn lu√¥n h·ªçc gi·ªèi, kh·ªèe m·∫°nh, g·∫∑p nhi·ªÅu may m·∫Øn v√† ng√†y c√†ng t·ª± tin tr√™n con ƒë∆∞·ªùng m√¨nh ch·ªçn. Mong m√≥n qu√† nh·ªè n√†y s·∫Ω l√† m·ªôt l·ªùi nh·∫Øn g·ª≠i r·∫±ng: ·ªü ƒë√¢u ƒë√≥, lu√¥n c√≥ nh·ªØng ng∆∞·ªùi b·∫°n tr√¢n tr·ªçng v√† y√™u qu√Ω Hi·ªÅn th·∫≠t l√≤ng. üíê" } ] },
        { id: 3, name: "Hi·∫øu Ng√¢n", avatar: "https://i.postimg.cc/cJn8J9wr/5.png", flowerEmoji: "üå∑", wishes: [ { text: "Ch√∫c H·ªì Hi·∫øu Ng√¢n c·ªßa t·ª•i b·∫°n 1 ng√†y 20/10 √Ω nghƒ©a.\nTr·∫£i qua g·∫ßn 10 nƒÉm t√¨nh b·∫°n ch√∫ng ta c≈©ng ƒë√£ qu√° hi·ªÉu nhau r·ªìi n√™n t ko mu·ªën l√≥i qu√° nhi·ªÅu ch·ªâ mu·ªën ch√∫c m ng√†y c√†ng xinh ƒë·∫πp, nhi·ªÅu s·ª©c kh·ªèe ƒë·ªÉ ƒëi ch∆°i vs t·ª•i t khi t·ª•i t v·ªÅ, nhi·ªÅu may m·∫Øn.\nCu·ªëi c√πng xin c·∫£m HHN ƒë√£ ƒë·ªìng h√†nh c√πng t·ª•i b qua 10 nƒÉm v√† c√≥ nhi·ªÅu k·ªâ ni·ªám ƒë·∫πp, c·∫£m ∆°n ƒë√£ l√† 1 ph·∫ßn thanh Xu√¢n tuy·ªát v·ªùi c·ªßa XPM" } ] },
        { id: 4, name: "Thanh Th·∫£o", avatar: "https://i.postimg.cc/xCVNNv3G/6.png", flowerEmoji: "üåº", wishes: [ { text: "G·ª≠i Th·∫£o th∆∞∆°ng m·∫øn,\nN·∫øu v√≠ Th·∫£o nh∆∞ m·ªôt lo√†i hoa, k·ª≥ th·ª±c ph·∫£i d√πng c·∫£ b√°ch hoa ƒê√¥ng T√¢y kim c·ªï ƒë·ªÉ l√†m n·ªÅn soi chi·∫øu. C√≥ l·∫Ω Th·∫£o nh∆∞ ƒë√≥a H·ªìng Nhung ki·ªÅu di·ªÖm, ki√™u sa trong v∆∞·ªùn th∆° Ph√°p, e ·∫•p, m·ªÅm m·∫°i gi·ªØa s∆∞∆°ng mai. C√≥ hay Th·∫£o l√† b√¥ng M·∫´u ƒê∆°n ng·ªçc ng√† trong v∆∞·ªùn th·ªßy m·∫∑c, thanh tao m√† ƒë·∫±m th·∫Øm, d·ªãu d√†ng. ¬†Ph·∫£i chƒÉng Th·∫£o nh·∫π nh√†ng t·ª±a nh√†nh li·ªÖu ƒëung ƒë∆∞a n∆°i g√≥c h·ªì trƒÉng t·ªè, l·∫°i nh∆∞ nh√†nh b√¥ng ƒê·ªó Quy√™n r·ª±c r·ª° t·ªèa s·∫Øc gi·ªØa n√∫i r·ª´ng hoa ban tr·∫Øng x√≥a. T·∫•t c·∫£ ch·∫≥ng th·ªÉ n√≥i h·∫øt c√°i nh√¨n v·ªÅ Th·∫£o.\nNh√¨n Th·∫£o, ‚Äúch√∫ng m√¨nh‚Äù th·∫•y c·∫£ m√πa thu n∆∞·ªõc √Åo trong ƒë√¥i m·∫Øt bi·∫øc, v√† c·∫£ trƒÉng non ƒë·∫•t Vi·ªát tr√™n v√†nh m√¥i c∆∞·ªùi. Gi·ªçng n√≥i Th·∫£o t·ª±u kh√∫c d∆∞∆°ng c·∫ßm du d∆∞∆°ng gi·ªØa ph·ªë c·ªï, l·∫°i l√† ƒëi·ªáu h√°t ru √™m √°i b√™n m√°i hi√™n nh√†. Th·∫£o ƒë·∫πp nh∆∞ n√†ng th∆° c·ªßa thi sƒ©, nh∆∞ng c≈©ng m·∫°nh m·∫Ω ƒë·∫ßy di·ªÖm l·ªá nh∆∞ n√†ng Th·ªã Lan c·ªßa ch√†ng Vƒ©nh Th·ª•y.\nNh√¢n ng√†y 20/10, ng√†y t√¥n vinh v·∫ª ƒë·∫πp c·ªßa ph·ª• n·ªØ Vi·ªát, ‚Äúch√∫ng m√¨nh‚Äù ch·ªâ d√°m th·∫ßm g·ª≠i nh·ªØng l·ªùi n√†y nh∆∞ nh·ªØng con chi√™ng mu·ªën ti·∫øn v·ªÅ v·ªõi ƒë·ª©c m·∫π. Ch√∫c em Th·∫£o ‚Äì ¬†ƒë√≥a hoa k·∫øt tinh tinh hoa ƒë·∫•t tr·ªùi, lu√¥n gi·ªØ m√£i n√©t e ·∫•p thu·ªü ban ƒë·∫ßu, s·ª± nƒÉng ƒë·ªông v·ªën c√≥, ƒë·ªÉ ƒë·ªùi m√£i ng·ª° ng√†ng tr∆∞·ªõc v·∫ª ƒë·∫πp h·ªôi t·ª• hai ph∆∞∆°ng tr·ªùi ·∫•y.\nTh∆∞∆°ng v√† m√£i nh·ªõ v·ªÅ Th·∫£o d·∫´u c√≥ v·∫Øng m·∫∑t hay ¬†xa c√°ch ƒë·∫øn v·∫°n tr√πng ƒë·∫°i d∆∞∆°ng," } ] },
        { id: 5, name: "Kh√°nh Xu√¢n", avatar: "https://i.postimg.cc/q7CPSwGv/8.png", flowerEmoji: "üåπ", wishes: [ { text: "20/10 t·ªõi r·ªìi n√® üå∏\n M·ªôt ng√†y ƒë·∫∑c bi·ªát ƒë·ªÉ m·∫•y ƒë·ª©a con trai t·ª•i m√¨nh d√†nh l·ªùi ch√∫c v√† s·ª± tr√¢n tr·ªçng cho nh·ªØng ng∆∞·ªùi con g√°i quanh m√¨nh ‚Äî nh·ªØng ng∆∞·ªùi lu√¥n m·∫°nh m·∫Ω, ki√™n nh·∫´n v√† bi·∫øt c√°ch l√†m cho cu·ªôc s·ªëng tr·ªü n√™n vui h∆°n m·ªói ng√†y. V√† t·∫•t nhi√™n, kh√¥ng th·ªÉ thi·∫øu l·ªùi ch√∫c g·ª≠i ƒë·∫øn Xu√¢n üòå\nXu√¢n l√∫c n√†o c≈©ng l√† ng∆∞·ªùi d·ªÖ th∆∞∆°ng, vui v·∫ª v√† c√≥ nƒÉng l∆∞·ª£ng ri√™ng m√† ai ch∆°i c√πng c≈©ng th·∫•y tho·∫£i m√°i. D√π c√≥ l√∫c h∆°i ‚Äúquay xe‚Äù t√≠ üòÜ nh∆∞ng ƒë√≥ c≈©ng l√† m·ªôt ph·∫ßn ƒë√°ng y√™u c·ªßa Xu√¢n. Hy v·ªçng Xu√¢n s·∫Ω lu√¥n gi·ªØ ƒë∆∞·ª£c vibe ƒë√≥ ‚Äî nh·∫π nh√†ng, t√≠ch c·ª±c, v√† ng√†y c√†ng xinh h∆°n nh∆∞ b√¢y gi·ªù üå∑\nCh√∫c Kh√°nh Xu√¢n c√≥ m·ªôt ng√†y 20/10 th·∫≠t nhi·ªÅu ni·ªÅm vui, lu√¥n gi·ªØ n·ª• c∆∞·ªùi v√† s·ªëng th·∫≠t chill. H√£y y√™u b·∫£n th√¢n h∆°n m·ªói ng√†y, v√¨ Xu√¢n x·ª©ng ƒë√°ng v·ªõi nh·ªØng ƒëi·ªÅu t·ªët ƒë·∫πp nh·∫•t üí´ Qu√° kh·ª© kh√©p l·∫°i r·ªìi th√¨ c·ª© ƒë·ªÉ n√≥ ·ªü ƒë√≥, ƒë·ª´ng quay l·∫°i n·ªØa. C·ª© m·ªü l√≤ng ra, ƒë√≥n nh·∫≠n nh·ªØng ƒëi·ªÅu m·ªõi, v√¨ ch·∫Øc ch·∫Øn t∆∞∆°ng lai s·∫Ω c√≥ nhi·ªÅu ni·ªÅm vui, nh·ªØng ng∆∞·ªùi t·ªët v√† c∆° h·ªôi m·ªõi ƒëang ch·ªù Xu√¢n ·ªü ph√≠a tr∆∞·ªõc üåª" } ] }
    ];
    const memoriesImages = ["https://i.postimg.cc/nrMkVH7M/55d7f5ab-8263-48c7-9448-a2621d0a7403.jpg", "https://i.postimg.cc/x87PcWy3/ea2374ee-7e72-4210-a95a-db3cf358c226.jpg", "https://i.postimg.cc/HkvfLj3H/kiniem1.jpg", "https://i.postimg.cc/cLLpZfRw/kiniem3.jpg", "https://i.postimg.cc/HkkqHbwQ/kiniem4.jpg", "https://i.postimg.cc/SR4PP9QY/kiniem5.jpg", "https://i.postimg.cc/ncHsbKk5/kiniem6.jpg", "https://i.postimg.cc/brPZv1jT/kiniem7.jpg", "https://i.postimg.cc/fyvJSkwP/kiniem8.jpg", "https://i.postimg.cc/c4XvsKkL/kiniem9.jpg", "https://i.postimg.cc/28zqRdGV/kiniem10.jpg", "https://i.postimg.cc/pXqm29cm/kiniem11.jpg", "https://i.postimg.cc/BbtgZqDZ/06ea8e60-613d-4f25-992c-6600b3fd59f2.jpg", "https://i.postimg.cc/cLLpZfRR/kiniem2.jpg", "https://i.postimg.cc/0jrf58my/9955b916-7bd5-4421-b459-9ad50cfb1462.jpg", "https://i.postimg.cc/c15h9nyd/aa865569-8ca9-4533-a768-57a0b910416d.jpg", "https://i.postimg.cc/rszJy8Wm/cfddc74e-832b-4cac-8204-190efb7e2c7e.jpg", "https://i.postimg.cc/zvMkV9Sn/eaa7c261-7eed-421b-bf3b-8b7a60913617.jpg", "https://i.postimg.cc/RCbdsH56/f28234cd-d333-4b46-a0e9-af225ed58e44.jpg", "https://i.postimg.cc/BbyCXdcF/f3be936f-5eb8-47c7-88cc-54531f8fed44.jpg", "https://i.postimg.cc/BZwpYK94/f54f052f-292a-4168-b035-6ed1965b6f74.jpg", "https://i.postimg.cc/BZwpYK9W/f66b995b-0b60-4791-bd28-86e2fc5d7313.jpg"];
    
    const API_KEY = "AIzaSyAZmEeoKadecC3SH86yH0vk6AZNy5kfgrs"; 
    const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${API_KEY}`;
    const fallingFlowers = ['üå∏', 'üå∫', 'üå∑', 'üíñ', '‚ú®', 'üåº', 'üåπ'];

    // =================================================================
    // C√ÅC H√ÄM TI·ªÜN √çCH
    // =================================================================
    function setupMemoriesGallery() {
        const galleryContainer = document.getElementById('memories-gallery');
        const imageModal = document.getElementById('image-modal');
        const modalImage = document.getElementById('modal-image');
        const modalCloseBtn = document.getElementById('modal-close-btn');
        galleryContainer.innerHTML = '';
        const galleryImages = memoriesImages.slice(0, 5); 
        const numImages = galleryImages.length;
        const centerIndex = Math.floor(numImages / 2);
        galleryImages.forEach((src, index) => {
            const container = document.createElement('div');
            container.className = 'memory-photo-container';
            const img = document.createElement('img');
            img.src = src;
            img.alt = `K·ª∑ ni·ªám ${index + 1}`;
            img.className = 'memory-photo w-44 md:w-56 h-auto';
            
            const angleSpread = 5;
            const horizontalSpread = window.innerWidth < 768 ? 130 : 180;
            
            const angle = (index - centerIndex) * angleSpread;
            const xOffset = (index - centerIndex) * horizontalSpread;
            const originalZIndex = numImages - Math.abs(index - centerIndex);
            const originalTransform = `translateX(${xOffset}px) rotate(${angle}deg)`;
            const hoverTransform = `translateX(${xOffset}px) rotate(${angle}deg) scale(1.1) translateY(-15px)`;
            
            container.style.transform = originalTransform;
            container.style.zIndex = originalZIndex;
            container.addEventListener('mouseenter', () => { container.style.transform = hoverTransform; container.style.zIndex = 50; });
            container.addEventListener('mouseleave', () => { container.style.transform = originalTransform; container.style.zIndex = originalZIndex; });
            container.appendChild(img);
            galleryContainer.appendChild(container);
            container.addEventListener('click', () => { modalImage.src = src; imageModal.classList.remove('hidden'); });
        });
        const closeModal = () => { imageModal.classList.add('hidden'); modalImage.src = ''; };
        modalCloseBtn.addEventListener('click', closeModal);
        imageModal.addEventListener('click', (e) => { if (e.target.id === 'image-modal') { closeModal(); } });
    }

    function setupThankYouCarousel() {
        const track = document.getElementById('mini-carousel-track');
        if (!track) return;
        track.innerHTML = '<p class="text-white/80 text-center w-full">ƒêang t·∫£i k·ª∑ ni·ªám...</p>';
        const imagesToAppend = [...memoriesImages, ...memoriesImages];
        const loadPromises = imagesToAppend.map(src => new Promise((resolve, reject) => {
            const img = new Image();
            img.src = src;
            img.onload = () => resolve(img);
            img.onerror = () => reject(new Error(`L·ªói t·∫£i ·∫£nh: ${src}`));
        }));
        Promise.all(loadPromises).then(loadedImages => {
            track.innerHTML = '';
            loadedImages.forEach(img => track.appendChild(img));
            track.classList.add('animate-scroll');
        }).catch(error => {
            console.error("Kh√¥ng th·ªÉ t·∫£i ·∫£nh cho carousel:", error);
            track.innerHTML = '<p class="text-red-400 text-center w-full">L·ªói t·∫£i ·∫£nh k·ª∑ ni·ªám.</p>';
        });
    }

    async function generateAiWish(name) {
        const prompt = `H√£y vi·∫øt m·ªôt b√†i th∆° ng·∫Øn kho·∫£ng 4-6 c√¢u, ho·∫∑c m·ªôt l·ªùi ch√∫c th·∫≠t √Ω nghƒ©a v√† s√°ng t·∫°o ƒë·ªÉ ch√∫c m·ª´ng ng√†y Ph·ª• n·ªØ Vi·ªát Nam 20/10 cho ng∆∞·ªùi b·∫°n t√™n l√† "${name}". H√£y d√πng gi·ªçng vƒÉn th√¢n thi·ªán, ·∫•m √°p, nh·∫•n m·∫°nh r·∫±ng c√¥ ·∫•y l√† m·ªôt ng∆∞·ªùi b·∫°n tuy·ªát v·ªùi v√† l√† m·ªôt ph·∫ßn quan tr·ªçng c·ªßa nh√≥m.`;
        const payload = { contents: [{ parts: [{ text: prompt }] }] };
        try {
            const response = await fetch(API_URL, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
            if (!response.ok) throw new Error(`API error: ${response.statusText}`);
            const result = await response.json();
            return result.candidates?.[0]?.content?.parts?.[0]?.text || "R·∫•t ti·∫øc, AI kh√¥ng th·ªÉ nghƒ© ra l·ªùi ch√∫c l√∫c n√†y. Nh∆∞ng b·∫°n v·∫´n l√† ng∆∞·ªùi tuy·ªát v·ªùi nh·∫•t!";
        } catch (error) {
            console.error("L·ªói khi g·ªçi API (ƒë√£ ƒë∆∞·ª£c thay b·∫±ng th√¥ng b√°o t√πy ch·ªânh):", error);
            return "∆† k√¨a, t·ª•i m√¨nh ch√∫c b·∫±ng c·∫£ t·∫•m l√≤ng m√† v·∫´n ch∆∞a ƒë·ªß ƒë√¥ sao? AI l√†m sao c√≥ 't√¨nh c·∫£m' ƒë∆∞·ª£c nh∆∞ t·ª•i m√¨nh ch·ª©! üòâ";
        }
    }

    function typeWriterEffect(element, text, delay = 30) {
       let i = 0;
       element.innerHTML = '';
       function type() {
           if (i < text.length) {
               element.innerHTML += text.charAt(i);
               i++;
               setTimeout(type, delay);
           }
       }
       type();
    }
    
    // =================================================================
    // LOGIC CH√çNH
    // =================================================================
    document.addEventListener('DOMContentLoaded', () => {
        const giftScreen = document.getElementById('gift-screen'), introScreen = document.getElementById('intro-screen'), homeScreen = document.getElementById('home-screen'), wishScreen = document.getElementById('wish-screen'), thankYouScreen = document.getElementById('thank-you-screen');
        const fanContainer = document.getElementById('fan-container'), finishReadingBtn = document.getElementById('finish-reading-btn'), generateAiWishBtn = document.getElementById('generate-ai-wish-btn');
        const aiWishContainer = document.getElementById('ai-wish-container'), aiWishLoading = document.getElementById('ai-wish-loading'), aiWishResult = document.getElementById('ai-wish-result');
        const fallingFlowerContainer = document.getElementById('falling-flower-container'), giftCard = document.getElementById('gift-card'), acceptGiftBtn = document.getElementById('accept-gift-button'), denyGiftBtn = document.getElementById('deny-gift-button');
        const continueToMainBtn = document.getElementById('continue-to-main-button'), backgroundMusic = document.getElementById('background-music');
        const heartFillScreen = document.getElementById('heart-fill-screen');
        const heartSvgContainer = document.getElementById('heart-svg-container');
        const clipRect = document.getElementById('clip-rect');
        const heartTitle = document.getElementById('heart-title');
        const heartsContainer = document.getElementById('falling-hearts-container');
        
        let selectedGirlId = null;
        backgroundMusic.volume = 0.5;

        setupMemoriesGallery();
        setupThankYouCarousel();

        acceptGiftBtn.addEventListener('click', () => {
            giftScreen.classList.add('hidden');
            introScreen.classList.remove('hidden');
            introScreen.classList.add('flex');
        });
        
        let denyClickCount = 0;
        denyGiftBtn.addEventListener('click', () => {
            denyClickCount++;
            if (denyClickCount === 1) {
                giftCard.querySelector('h2').textContent = '∆†... Th·∫≠t s·ª± kh√¥ng mu·ªën nh·∫≠n th·∫≠t √†! ';
                giftCard.querySelector('p').textContent = 'B·ªçn m√¨nh ƒë√£ gi√†nh r·∫•t nhi·ªÅu t√¢m huy·∫øt v√† c√¥ng s·ª©c v√†o m√≥n qu√† n√†y ƒë·∫•y. Nh·∫≠n ƒëi cho b·ªçn m√¨nh vui m√†';
                acceptGiftBtn.textContent = 'üéÅ Okii, nh·∫≠n n√®!';
                acceptGiftBtn.classList.add('animate-pulse');
                denyGiftBtn.textContent = 'ƒê√£ b·∫£o kh√¥ng l√† kh√¥ng! üò§';
            } else {
                if (denyGiftBtn.style.position !== 'fixed') {
                    const rect = denyGiftBtn.getBoundingClientRect();
                    denyGiftBtn.style.position = 'fixed';
                    denyGiftBtn.style.left = `${rect.left}px`;
                    denyGiftBtn.style.top = `${rect.top}px`;
                    denyGiftBtn.style.zIndex = '10000';
                }
                const maxX = window.innerWidth - denyGiftBtn.offsetWidth, maxY = window.innerHeight - denyGiftBtn.offsetHeight;
                const randomX = Math.floor(Math.random() * maxX), randomY = Math.floor(Math.random() * maxY);
                denyGiftBtn.style.left = `${randomX}px`;
                denyGiftBtn.style.top = `${randomY}px`;
            }
        });
        
        continueToMainBtn.addEventListener('click', () => {
            introScreen.classList.add('hidden');
            homeScreen.classList.remove('hidden');
            homeScreen.classList.add('flex');
        });

        function showWishCard(girlId) {
            const girl = girlsData.find(g => g.id === parseInt(girlId));
            if (!girl) return;

            const wishTitleElement = document.getElementById('wish-title');
            wishTitleElement.textContent = `G·ª≠i ${girl.name},`;
            
            document.getElementById('wish-image').src = girl.avatar;
            const wishTextContainer = document.getElementById('wish-text');
            wishTextContainer.innerHTML = '';
            
            girl.wishes.forEach(wish => {
                const p = document.createElement('p');
                let wordCounter = 0;
                const parts = wish.text.split(/(\s+)/);
                parts.forEach(part => {
                    if (part.trim() !== '') {
                        const wordSpan = document.createElement('span');
                        wordSpan.textContent = part;
                        wordSpan.className = 'word-fall-in';
                        wordSpan.style.animationDelay = `${wordCounter * 0.05}s`;
                        p.appendChild(wordSpan);
                        wordCounter++;
                    } else {
                        const spaceSpan = document.createElement('span');
                        spaceSpan.textContent = part;
                        spaceSpan.style.whiteSpace = 'pre-wrap';
                        p.appendChild(spaceSpan);
                    }
                });
                wishTextContainer.appendChild(p);
            });

            generateAiWishBtn.dataset.girlId = girlId;
            aiWishContainer.classList.add('hidden');
            aiWishResult.textContent = '';
            
            wishScreen.classList.remove('hidden', 'open');
            wishScreen.classList.add('flex');
            
            let envelopeContainer = document.getElementById('envelope-container');
            const newEnvelopeContainer = envelopeContainer.cloneNode(true);
            envelopeContainer.parentNode.replaceChild(newEnvelopeContainer, envelopeContainer);
            newEnvelopeContainer.addEventListener('click', () => wishScreen.classList.add('open'), { once: true });
            
            window.scrollTo(0, 0);
        }

        function displayWishFor(girlId) {
            selectedGirlId = girlId;
            homeScreen.classList.add('hidden');
            heartFillScreen.classList.remove('hidden');
            heartFillScreen.classList.add('flex');
            resetHeartAnimation();
        }

        girlsData.forEach((girl, index) => {
            const angle = (index - (girlsData.length - 1) / 2) * 15;
            const container = document.createElement('div');
            container.className = 'girl-card-container';
            container.style.setProperty('--flower-emoji', `'${girl.flowerEmoji}'`);
            container.style.transform = `rotate(${angle}deg)`;
            container.style.zIndex = girlsData.length - Math.abs(index - (girlsData.length - 1) / 2);

            const girlCard = document.createElement('img');
            girlCard.src = girl.avatar;
            girlCard.alt = `·∫¢nh c·ªßa ${girl.name}`;
            girlCard.className = 'girl-card';
            girlCard.addEventListener('click', () => displayWishFor(girl.id));
            
            container.appendChild(girlCard);
            fanContainer.appendChild(container);
        });

        const totalProgress = 100;
        let currentProgress = 0;
        let physicalClickCount = 0;
        const svgHeight = 24;

        function createFallingHeart() {
            const heart = document.createElement('div');
            heart.innerHTML = '‚ù§Ô∏è';
            heart.classList.add('falling-heart');
            heart.style.left = `${Math.random() * 100}vw`;
            heart.style.animationDuration = `${Math.random() * 2 + 3}s`;
            heart.style.fontSize = `${Math.random() * 1.5 + 0.5}rem`;
            heart.style.opacity = Math.random() * 0.7 + 0.3;
            heartsContainer.appendChild(heart);
            setTimeout(() => { heart.remove(); }, 5000);
        }

        function resetHeartAnimation() {
            currentProgress = 0;
            physicalClickCount = 0;
            clipRect.setAttribute('y', svgHeight);
            heartTitle.textContent = 'Ch·∫°m v√†o tr√°i tim ƒë·ªÉ nh·∫≠n m√≥n qu√† n√†y nh√©!';
            heartFillScreen.classList.remove('fade-out');
        }

        heartSvgContainer.addEventListener('click', () => {
            if (currentProgress >= totalProgress) return;

            for(let i = 0; i < 5; i++) { createFallingHeart(); }
            physicalClickCount++;
            
            if (currentProgress < 7) {
                // Giai ƒëo·∫°n r·∫•t ch·∫≠m: tƒÉng 1 ƒë∆°n v·ªã m·ªói l·∫ßn click
                currentProgress += 1;
            } else {
                // Giai ƒëo·∫°n si√™u nhanh: gia s·ªë l·ªõn v√† tƒÉng nhanh d·∫ßn
                let increment = 4 + Math.floor((currentProgress - 7) / 5);
                currentProgress += increment;
            }
            
            currentProgress = Math.min(currentProgress, totalProgress); // ƒê·∫£m b·∫£o kh√¥ng v∆∞·ª£t qu√° 100
            
            const newY = svgHeight - (svgHeight * (currentProgress / totalProgress));
            clipRect.setAttribute('y', newY);

            if (physicalClickCount === 5) heartTitle.textContent = "M√≥n qu√† ƒëang ƒë∆∞·ª£c ƒë√≥ng g√≥i m·ªôt c√°ch ch·ªânh chu nh·∫•t...";
            else if (physicalClickCount === 10) heartTitle.textContent = "S·∫Øp xong r·ªìi, c·ªë l√™n m·ªôt ch√∫t n·ªØa th√¥i!";
            else if (currentProgress > 75) heartTitle.textContent = "S·∫Øp m·ªü ƒë∆∞·ª£c qu√† r·ªìi ƒë·∫•y!C√≥ h·ªìi h·ªôp kh√¥ng n√†o ?";

            if (currentProgress >= totalProgress) {
                heartTitle.textContent = 'M√≥n qu√† ƒë√£ ƒë∆∞·ª£c ƒë√≥ng g√≥i th√†nh c√¥ng!';
                setTimeout(() => {
                    heartFillScreen.classList.add('fade-out');
                    setTimeout(() => {
                        heartFillScreen.classList.add('hidden');
                        heartFillScreen.classList.remove('flex');
                        if (selectedGirlId) {
                            showWishCard(selectedGirlId);
                        }
                    }, 700);
                }, 1000);
            }
        });

        finishReadingBtn.addEventListener('click', () => {
            wishScreen.classList.add('hidden');
            wishScreen.classList.remove('flex', 'open');
            thankYouScreen.classList.remove('hidden');
            thankYouScreen.classList.add('flex');
            setTimeout(() => {
                const thankYouCard = thankYouScreen.querySelector('.bg-white\\/80');
                thankYouCard.classList.remove('scale-95', 'opacity-0');
            }, 100);
            backgroundMusic.play().catch(e => console.log("Tr√¨nh duy·ªát kh√¥ng cho ph√©p t·ª± ƒë·ªông ph√°t nh·∫°c."));
        });

        generateAiWishBtn.addEventListener('click', async () => {
            const girlId = generateAiWishBtn.dataset.girlId;
            const girl = girlsData.find(g => g.id === parseInt(girlId));
            if(!girl) return;
            aiWishContainer.classList.remove('hidden');
            aiWishResult.classList.add('hidden');
            aiWishLoading.classList.remove('hidden');
            generateAiWishBtn.disabled = true;
            generateAiWishBtn.classList.add('opacity-50');
            const wish = await generateAiWish(girl.name);
            aiWishLoading.classList.add('hidden');
            aiWishResult.classList.remove('hidden');
            typeWriterEffect(aiWishResult, wish, 30);
            generateAiWishBtn.disabled = false;
            generateAiWishBtn.classList.remove('opacity-50');
        });
        
        // Block code cho n√∫t restart ƒë√£ b·ªã x√≥a
    });
</script>

</body>
</html>


